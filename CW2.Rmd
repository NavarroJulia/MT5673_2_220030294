---
title: "Monte Carlo simulation (R)"
author: "Julia Navarro"
date: "October 2022"
output: html_document
---
    
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## Problem A 

<!--- Tasks:

Problem A
• Consider the following independent random variables:
– X ∼ N (µ = 4, σ2 = 10)
– Y ∼ U(a = 2, b = 8)
• Compute the probability that X > Y , i.e. Pr(X > Y ).
• Use bootstrapping to derive the sampling distribution for your estimate of Pr(X > Y ).
• Show how the sample variance of this sampling distribution changes as a function of the number of
Monte Carlo simulations.

--->
 
``` {r, echo = FALSE}

## Compute the probability that X > Y , i.e. Pr(X > Y ):

num_sim = 100

set.seed(314)

## create a vector of length num_sim of all zeros:
P <- rep(0, num_sim) 

for(i in 1:num_sim){

X <- rnorm(1, mean=4, sd=sqrt(10))
Y <- runif(1, min=2, max=8)

if(X>Y){
  
  P[i] <- 1
  
      }
}

print(sum(P)/num_sim)




## Use bootstrapping to derive the sampling distribution for your estimate of Pr(X > Y)


## calculate each probability and store it in vector and then find sampling distribution

## set seed:
set.seed(413)

## create vectors of probabilities:
x <- rnorm(num_sim, mean=4, sd=sqrt(10))
y <- runif(num_sim, min=2, max=8)

## store in data.frame:
obsData <- data.frame(x, y) 




## need data from both X and Y. We then use the bootstrap method with replacement and apply the function
## as used above to calculate the probability (need to derive a sampling distribution)


# Initialisation

NRepeat <- 500 # no. of bootstrapped samples

bootRes <- matrix(data = 0, nrow = NRepeat, ncol = 1) # results

 
S <- matrix(0, num_sim, NRepeat)



#########


## Values are after the first 100 values


#########


#   i in seq(NRepeat)

# Loop across all samples
for (i in 1:NRepeat){
  
  ## Resample with replacement:
  
  bootData <- obsData[sample(x = num_sim, size = num_sim, replace = T),]
  
  
  ## calculate the probability associated with this new shuffled data:
  
  for (j in 1:nrow(bootData)){
    
    if(bootData[j,1] > bootData[j,2]){
         
     S[j,i] <- 1
     
     
     bootRes[i] <- (sum(S[,j])/num_sim) 
     
    }
  }
}




```

## Problem B

<!--- 


Problem B
• Consider the following football tournament format: a team keeps playing until they accrue 7 wins or 3
losses (whichever comes first - no draws allowed). Assume a fixed win rate p ∈ [0, 1] across all rounds
(they are paired at random).
• Plot how the total number of matches played (i.e. wins + losses) varies as a function of p.
• Comment on the observed win rate relative to the assumed win rate p (i.e. if a team obtains 2 wins -
3 losses, the maximum likelihood point estimate for their win rate is 40%). Specifically, focus on the
effect driven by the format of this tournament.

--->
